<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <title>商票详情</title>
  <link rel="stylesheet" href="lib/layui/css/layui.css">
</head>

<body>
  <h1 style="margin: 50px;">确认抵押的商票</h1>
  <form class="layui-form" action="" style="width: 500px;margin:20px 150px;">
    <label class="layui-form-label" style="width:100px;color:tomato">抵押信息：</label>
    <div class="layui-form-item">
      <label class="layui-form-label">贷款金额</label>
      <div class="layui-input-block">
        <input disabled type="text" name="title" lay-verify="" placeholder="全称" autocomplete="off" class="layui-input"
          style="width: 190px;" id="price1">
      </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">贷款时间</label>
        <div class="layui-input-block">
          <input disabled type="text" name="title" lay-verify="" placeholder="贷款时间" autocomplete="off" class="layui-input"
            style="width: 190px;" id="date1">
        </div>
      </div>
    <div class="layui-form-item">
      <label class="layui-form-label">全称</label>
      <div class="layui-input-block">
        <input disabled type="text" name="title" lay-verify="" placeholder="全称" autocomplete="off" class="layui-input"
          style="width: 190px;" id="acceptancerUser1">
      </div>
    </div>
    <div class="layui-form-item">
      <label class="layui-form-label">开户行行号</label>
      <div class="layui-input-block">
        <input disabled type="text" name="title" lay-verify="" placeholder="全称" autocomplete="off" class="layui-input"
          style="width: 190px;" id="acceptancerBankNum1">
      </div>
    </div>
    <div class="layui-form-item">
      <label class="layui-form-label">账号</label>
      <div class="layui-input-block">
        <input disabled type="text" name="title" lay-verify="" placeholder="账号" autocomplete="off" class="layui-input"
          style="width: 190px;" id="acceptancerAccount1">
      </div>
    </div>
    <div class="layui-form-item">
      <label class="layui-form-label">开户行名称</label>
      <div class="layui-input-block">
        <input disabled type="text" name="title" lay-verify="" placeholder="开户行名称" autocomplete="off"
          class="layui-input" style="width: 190px;" id="acceptancerBank1">
      </div>
    </div>
    <label class="layui-form-label" style="width:100px;color: #009688">出票信息：</label>

    <div class="layui-form-item">
      <label class="layui-form-label">出票日期</label>
      <input disabled type="text" class="layui-input test-item" style="width: 190px;" placeholder="出票日期" id="issueDate">
    </div>
    <div class="layui-form-item">
      <label class="layui-form-label">汇票到期日</label>
      <input disabled type="text" class="layui-input test-item" style="width: 190px;" placeholder="汇票到期日"
        id="expireDate">
    </div>
    <div class="layui-form-item">
      <label class="layui-form-label">票据金额</label>
      <div class="layui-input-block">
        <input disabled type="number" min="100" name="title" lay-verify="" placeholder="票据金额，小写数字" autocomplete="off"
          class="layui-input" style="width: 190px;" id="price">
      </div>
    </div>
    <div class="layui-form-item">
      <label class="layui-form-label">交易合同号</label>
      <div class="layui-input-block">
        <input disabled type="text" name="title" lay-verify="" placeholder="交易合同号" autocomplete="off"
          class="layui-input" style="width: 190px;" id="contractNumber">
      </div>
    </div>
    <div class="layui-form-item">
      <label class="layui-form-label">能否转让</label>
      <div class="layui-input-block" style="width: 190px;">
        <input disabled type="text" name="title" lay-verify="" placeholder="交易合同号" autocomplete="off"
          class="layui-input" style="width: 190px;" id="giveWay">
      </div>
    </div>
    <label class="layui-form-label" style="width:100px;color: #009688">出票人信息：</label>
    <div class="layui-form-item">
      <label class="layui-form-label">全称</label>
      <div class="layui-input-block">
        <input disabled type="text" name="title" lay-verify="" placeholder="全称" autocomplete="off" class="layui-input"
          style="width: 190px;" id="issueUser">
      </div>
    </div>
    <div class="layui-form-item">
      <label class="layui-form-label">账号</label>
      <div class="layui-input-block">
        <input disabled type="text" name="title" lay-verify="" placeholder="账号" autocomplete="off" class="layui-input"
          style="width: 190px;" id="issueAccount">
      </div>
    </div>
    <div class="layui-form-item">
      <label class="layui-form-label">开户银行</label>
      <div class="layui-input-block">
        <input disabled type="text" name="title" lay-verify="" placeholder="开户银行" autocomplete="off" class="layui-input"
          style="width: 190px;" id="issueBank">
      </div>
    </div>
    <label class="layui-form-label" style="width:100px;color: #009688">收票人信息：</label>
    <div class="layui-form-item">
      <label class="layui-form-label">全称</label>
      <div class="layui-input-block">
        <input disabled type="text" name="title" lay-verify="" placeholder="全称" autocomplete="off" class="layui-input"
          style="width: 190px;" id="receiveUser">
      </div>
    </div>
    <div class="layui-form-item">
      <label class="layui-form-label">账号</label>
      <div class="layui-input-block">
        <input disabled type="text" name="title" lay-verify="" placeholder="账号" autocomplete="off" class="layui-input"
          style="width: 190px;" id="receiveAccount">
      </div>
    </div>
    <div class="layui-form-item">
      <label class="layui-form-label">开户银行</label>
      <div class="layui-input-block">
        <input disabled type="text" name="title" lay-verify="" placeholder="开户银行" autocomplete="off" class="layui-input"
          style="width: 190px;" id="receiveBank">
      </div>
    </div>
    <label class="layui-form-label" style="width:100px;color: #009688">出票保证信息：</label>
    <div class="layui-form-item">
      <label class="layui-form-label">保证人姓名</label>
      <div class="layui-input-block">
        <input disabled type="text" name="title" lay-verify="" placeholder="保证人姓名" autocomplete="off"
          class="layui-input" style="width: 190px;" id="ensurerName">
      </div>
    </div>
    <div class="layui-form-item">
      <label class="layui-form-label">保证人地址</label>
      <div class="layui-input-block">
        <input disabled type="text" name="title" lay-verify="" placeholder="保证人地址" autocomplete="off"
          class="layui-input" style="width: 190px;" id="ensurerAddress">
      </div>
    </div>
    <div class="layui-form-item">
      <label class="layui-form-label">保证日期</label>
      <input disabled type="text" class="layui-input test-item" style="width: 190px;" placeholder="保证日期"
        id="ensureDate">
    </div>
    <label class="layui-form-label" style="width:100px;color: #009688">承兑人信息：</label>
    <div class="layui-form-item">
      <label class="layui-form-label">全称</label>
      <div class="layui-input-block">
        <input disabled type="text" name="title" lay-verify="" placeholder="全称" autocomplete="off" class="layui-input"
          style="width: 190px;" id="acceptancerUser">
      </div>
    </div>
    <div class="layui-form-item">
      <label class="layui-form-label">开户行行号</label>
      <div class="layui-input-block">
        <input disabled type="text" name="title" lay-verify="" placeholder="全称" autocomplete="off" class="layui-input"
          style="width: 190px;" id="acceptancerBankNum">
      </div>
    </div>
    <div class="layui-form-item">
      <label class="layui-form-label">账号</label>
      <div class="layui-input-block">
        <input disabled type="text" name="title" lay-verify="" placeholder="账号" autocomplete="off" class="layui-input"
          style="width: 190px;" id="acceptancerAccount">
      </div>
    </div>
    <div class="layui-form-item">
      <label class="layui-form-label">开户行名称</label>
      <div class="layui-input-block">
        <input disabled type="text" name="title" lay-verify="" placeholder="开户行名称" autocomplete="off"
          class="layui-input" style="width: 190px;" id="acceptancerBank">
      </div>
    </div>
    <label class="layui-form-label" style="width:100px;color: #009688">承兑信息：</label>
    <div class="layui-form-item">
      <label class="layui-form-label">出票人承诺</label>
      <div class="layui-input-block">
        <input disabled type="text" name="title" lay-verify="" disabled value="本汇票请予以承兑，到期无条件付款" autocomplete="off"
          class="layui-input" style="width: 250px;" id="issuePromise">
      </div>
    </div>
    <div class="layui-form-item">
      <label class="layui-form-label">承兑人承兑</label>
      <div class="layui-input-block">
        <input disabled type="text" name="title" lay-verify="" disabled value="本汇票已经承兑，到期无条件付款" autocomplete="off"
          class="layui-input" style="width: 250px;" id="acceptancerAcceptance">
      </div>
    </div>
    <div class="layui-btn" lay-submit lay-filter="formDemo" id="agree" style="margin:5px 250px;">收到钱款，确认转让</div>
  </form>

  <script src="lib/layui/layui.all.js"></script>
  <script src="lib/ajax.js"></script>
  <script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
  <script>
    var id
    var uid = JSON.parse(localStorage.getItem("user")).id;
    //由于模块都一次性加载，因此不用执行 layui.use() 来加载对应模块，直接使用即可：
    ;
    ! function () {
      var layer = layui.layer,
        form = layui.form;

    }();

    $(function () {
      // 接收
      var url = window.location.search;
      var urlResult = [];
      var arrUrl = url.substr(1).split("&");
      //遍历
      for (var j = 0; j < arrUrl.length; j++) {
        urlResult[j] = decodeURI(arrUrl[j].split("=")[1]);
      }
      id = urlResult[0];
      res = getRequest("http://localhost:8089/v1/ticket/ticketsById?ticketId=" + id);

      $('#acceptancerAcceptance').val(res.data.acceptancerAcceptance);
      $('#acceptancerAccount').val(res.data.acceptancerAccount);
      $('#acceptancerBank').val(res.data.acceptancerBank);
      $('#acceptancerBankNum').val(res.data.acceptancerBankNum);
      $('#acceptancerUser').val(res.data.acceptancerUser);
      $('#ensureDate').val(res.data.ensureDate);
      $('#ensurerAddress').val(res.data.ensurerAddress);
      $('#ensurerName').val(res.data.ensurerName);
      $('#expireDate').val(res.data.expireDate);
      $('#giveWay').val(res.data.giveWay);
      $('#issueAccount').val(res.data.issueAccount);
      $('#issueBank').val(res.data.issueBank);
      $('#issueDate').val(res.data.issueDate);
      $('#issuePromise').val(res.data.issuePromise);
      $('#issueUser').val(res.data.issueUser);
      $('#price').val(res.data.price);
      $('#receiveAccount').val(res.data.receiveAccount);
      $('#receiveBank').val(res.data.receiveBank);
      $('#receiveUser').val(res.data.receiveUser);
      $('#contractNumber').val(res.data.contractNumber);

      //被转让人
      var switch1 = JSON.parse(res.data.switchInfo);
      $('#acceptancerAccount1').val(res.data.dkAccount);
      $('#acceptancerBank1').val(res.data.dkBank);
      $('#acceptancerBankNum1').val(res.data.dkBankNum);
      $('#acceptancerUser1').val(res.data.dkUser);
      $('#price1').val(res.data.dkPrice);
      $('#date1').val(res.data.dkDate);
      console.log(res);
    });

    $('#agree').click(function () {
      var json = {"ticketId":Number(id),"userId":uid}
      var res = postRequest('http://localhost:8089/v1/ticket/confirmMortgage',json);
      layer.msg(res.msg);
      setTimeout(function () {
        location.reload();
      }, 1000);
    });
    // $('#disagree').click(function(){
    //   var json = {'ticketId':id}
    //   var res = postRequset('http://localhost:8089/v1/ticket/confirmTicket',json);
    //   layer.msg(res.msg);
    // });
  </script>
</body>

</html>